version: 1
type: view
name: order_lines
description: Description of order_lines view.
model_name: pure_organics
sql_table_name: DEMO_PROD.ORDER_LINES
default_date: order
row_label: Order line
identifiers:
  - name: product_id
    type: foreign
    sql: ${product_id}
  - name: customer_id
    type: foreign
    sql: ${customer_id}
fields:
  - name: order_line_id
    field_type: dimension
    type: string
    hidden: true
    primary_key: true
    label: Order Line Id
    sql: ${TABLE}.ORDER_LINE_ID
    searchable: false

  - name: customer_id
    field_type: dimension
    type: string
    hidden: false
    description: Represents the id of each customer
    drill_fields:
      - customers.email
      - customers.state
      - customers.city
      - customers.zipcode
    sql: ${TABLE}.CUSTOMER_ID
    tags:
      - customer
    searchable: false

  - name: order_id
    field_type: dimension
    type: string
    hidden: false
    drill_fields:
      - order_date
      - subscription_vs_otp
      - marketing_channel
      - campaign
      - promotion
      - total_gross_revenue
    sql: ${TABLE}.ORDER_ID
    tags:
      - order
    searchable: false

  - name: product_id
    field_type: dimension
    type: string
    hidden: true
    sql: ${TABLE}.PRODUCT_ID
    searchable: false

  - name: discount
    field_type: dimension
    type: number
    hidden: true
    sql: ${TABLE}.DISCOUNT

  - name: revenue
    field_type: dimension
    type: number
    hidden: true
    sql: ${TABLE}.REVENUE

  - name: price
    field_type: dimension
    type: number
    hidden: true
    sql: ${TABLE}.PRICE

  - name: quantity
    field_type: dimension
    type: number
    hidden: true
    sql: ${TABLE}.QUANTITY

  - name: campaign
    field_type: dimension
    type: string
    hidden: false
    description: >-
      The marketing campaign that the customer came through before placing their
      order.
    sql: ${TABLE}.CAMPAIGN
    searchable: true

  - name: promotion
    field_type: dimension
    type: string
    hidden: false
    description: The promotion given to the customer for this order
    sql: ${TABLE}.PROMOTION
    searchable: true

  - name: subscription_vs_otp
    field_type: dimension
    type: string
    hidden: false
    description: Whether the order was from a subscription or a one time purchase (OTP)
    sql: ${TABLE}.SUBSCRIPTION_VS_OTP
    searchable: true

  - name: marketing_source
    field_type: dimension
    type: string
    hidden: false
    description: >-
      The marketing source that the customer came through before placing their
      order.
    sql: ${TABLE}.MARKETING_SOURCE
    searchable: true

  - name: marketing_channel
    field_type: dimension
    type: string
    hidden: false
    description: >-
      The marketing channel that the customer came through before placing their
      order.
    sql: ${TABLE}.MARKETING_CHANNEL
    searchable: true

  - name: last_click_marketing_channel
    field_type: dimension
    type: string
    hidden: false
    description: >-
      The last click marketing channel that the customer came through before
      placing their order.
    sql: ${TABLE}.last_click
    searchable: true

  - name: first_click_marketing_channel
    field_type: dimension
    type: string
    hidden: false
    description: >-
      The first click marketing channel that the customer came through before
      placing their order.
    sql: ${TABLE}.first_click
    searchable: true

  - name: new_vs_repeat
    field_type: dimension
    type: string
    hidden: false
    description: >-
      Whether the customer placing the order was a new customer or a returning
      customer
    sql: ${TABLE}.new_vs_repeat
    searchable: true

  - name: order
    field_type: dimension_group
    type: time
    datatype: timestamp
    hidden: false
    label: Order Date
    description: >-
      The time at which the order was placed. This is the main time field to use
      for orders
    timeframes:
      - raw
      - date
      - week_index
      - week
      - month_of_year
      - month
      - quarter
      - year
      - hour_of_day
      - day_of_week
    sql: ${TABLE}.ORDER_AT

  - name: total_gross_revenue
    field_type: measure
    type: sum
    canon_date: order_lines.order
    label: Total Gross Revenue
    primary_key: false
    sql: ${revenue}
    synonyms:
      - sales
      - revenue
    value_format_name: usd

  - name: total_discounts
    field_type: measure
    type: sum
    hidden: false
    description: All discounts applied to either the order or the product in the order
    value_format_name: usd
    sql: ${discount}

  - name: number_of_customers_with_orders
    field_type: measure
    type: count_distinct
    hidden: false
    description: The unique number of customers who placed orders
    value_format_name: decimal_0
    sql: ${customer_id}

  - name: number_of_orders
    field_type: measure
    type: count_distinct
    hidden: false
    description: The unique number of orders placed
    value_format_name: decimal_0
    sql: ${order_id}

  - name: number_of_units
    field_type: measure
    type: sum
    hidden: false
    label: Number Of Units
    description: >-
      The unique number of units purchased (e.g. customer orders: 2 lip gloss
      and 1 blush = 3 units sold)
    value_format_name: decimal_0
    sql: ${quantity}

  - name: total_cogs
    field_type: measure
    type: sum
    hidden: false
    label: Total COGS
    description: The allocated cost of goods sold to the order line
    value_format_name: usd
    sql: ${TABLE}.cogs

  - name: total_net_revenue
    field_type: measure
    type: number
    hidden: false
    description: Total net revenue = gross revenue - discounts
    value_format_name: usd
    sql: ${total_gross_revenue} - ${total_discounts}

  - name: repurchase_rate
    field_type: measure
    type: number
    hidden: false
    description: Repurchase rate = number of repeat orders / number of orders.
    value_format_name: percent_1
    sql: ${number_of_repeat_orders} / ${number_of_orders}
    synonyms:
      - Repeat order rate

  - name: gross_aov
    field_type: measure
    type: number
    hidden: false
    description: Gross AOV = gross revenues / number of orders
    value_format_name: usd
    sql: ${total_gross_revenue} / nullif(${number_of_orders}, 0)
    synonyms:
      - Average order value

  - name: gross_profit
    field_type: measure
    type: number
    hidden: false
    description: The total net revenue - allocated cost of goods sold to the order line
    value_format_name: usd
    sql: ${total_net_revenue} - ${total_cogs}
    zoe_description: This is the gross profit.

  - name: units_per_order
    field_type: measure
    type: number
    label: Units per Order
    description: >-
      Number of units per order calculated as total number of units divided by
      total number of orders.
    value_format_name: decimal_1
    sql: >-
      ${order_lines.number_of_units} / nullif(${order_lines.number_of_orders},
      0)

  - name: total_gross_revenue_from_advertising
    field_type: measure
    type: sum
    hidden: true
    description: Total gross revenue = revenue from product sales + shipping revenues
    value_format_name: usd
    sql: ${revenue}
    filters:
      - field: marketing_channel
        value: '-Organic'
    synonyms:
      - sales
      - revenue

  - name: subscription_revenue
    field_type: measure
    type: sum
    hidden: false
    description: >-
      Subscription revenue = gross revenue (product revenues + shipping,for
      subscriptions only)
    value_format_name: usd
    sql: ${revenue}
    filters:
      - field: subscription_vs_otp
        value: Subscription

  - name: number_of_new_customers_with_orders
    field_type: measure
    type: count_distinct
    hidden: false
    description: The unique number of new customers who placed orders
    value_format_name: decimal_0
    sql: ${customer_id}
    filters:
      - field: new_vs_repeat
        value: New

  - name: number_of_repeat_orders
    field_type: measure
    type: count_distinct
    hidden: false
    description: >-
      The unique number of orders placed by customers who have placed at least
      one order before
    value_format_name: decimal_0
    sql: ${order_id}
    filters:
      - field: new_vs_repeat
        value: Repeat

  - name: avg_products_per_order
    field_type: measure
    type: number
    hidden: true
    description: Total gross revenue = revenue from product sales + shipping revenues
    value_format_name: decimal_1
    sql: ${products.number_of_products} / ${number_of_orders}
  - id: order_lines.TRIPPLE_REVENUE_IKDLIWRR
    name: tripple_revenue_ikdliwrr
    label: Triple Revenue
    value: ORDER_LINES_TRIPPLE_REVENUE_IKDLIWRR
    explores:
      - merged_result_canon_date_core_date
      - merged_result_canon_date_core_day_of_week
      - merged_result_canon_date_core_hour_of_day
      - merged_result_canon_date_core_month
      - merged_result_canon_date_core_month_of_year
      - merged_result_canon_date_core_quarter
      - merged_result_canon_date_core_raw
      - merged_result_canon_date_core_week
      - merged_result_canon_date_core_week_index
      - merged_result_canon_date_core_year
      - merged_result_subquery_0_subquery_1_date
      - merged_result_subquery_0_subquery_1_day_of_week
      - merged_result_subquery_0_subquery_1_hour_of_day
      - merged_result_subquery_0_subquery_1_month
      - merged_result_subquery_0_subquery_1_month_of_year
      - merged_result_subquery_0_subquery_1_quarter
      - merged_result_subquery_0_subquery_1_raw
      - merged_result_subquery_0_subquery_1_week
      - merged_result_subquery_0_subquery_1_week_index
      - merged_result_subquery_0_subquery_1_year
      - merged_result_subquery_1_subquery_2_date
      - merged_result_subquery_1_subquery_2_day_of_week
      - merged_result_subquery_1_subquery_2_hour_of_day
      - merged_result_subquery_1_subquery_2_month
      - merged_result_subquery_1_subquery_2_month_of_year
      - merged_result_subquery_1_subquery_2_quarter
      - merged_result_subquery_1_subquery_2_raw
      - merged_result_subquery_1_subquery_2_week
      - merged_result_subquery_1_subquery_2_week_index
      - merged_result_subquery_1_subquery_2_year
      - merged_result_subquery_1_subquery_3_date
      - merged_result_subquery_1_subquery_3_day_of_week
      - merged_result_subquery_1_subquery_3_hour_of_day
      - merged_result_subquery_1_subquery_3_month
      - merged_result_subquery_1_subquery_3_month_of_year
      - merged_result_subquery_1_subquery_3_quarter
      - merged_result_subquery_1_subquery_3_raw
      - merged_result_subquery_1_subquery_3_week
      - merged_result_subquery_1_subquery_3_week_index
      - merged_result_subquery_1_subquery_3_year
      - merged_result_subquery_1_subquery_4_date
      - merged_result_subquery_1_subquery_4_day_of_week
      - merged_result_subquery_1_subquery_4_hour_of_day
      - merged_result_subquery_1_subquery_4_month
      - merged_result_subquery_1_subquery_4_month_of_year
      - merged_result_subquery_1_subquery_4_quarter
      - merged_result_subquery_1_subquery_4_raw
      - merged_result_subquery_1_subquery_4_week
      - merged_result_subquery_1_subquery_4_week_index
      - merged_result_subquery_1_subquery_4_year
      - subquery_1
    joinable_explores:
      - subquery_1
    view_name: order_lines
    model_name: pure_organics
    datatype: null
    primary_key: false
    dimension_group_roll_up: null
    group_roll_up_label: Triple Revenue
    roll_up: null
    roll_up_label: null
    view_label: Order Lines
    date_column_sampling: __mappings__.DATE
    category_column_id: products.PRODUCT_TITLE
    is_additive: true
    read_only: false
    show_in_homepage: true
    field_type: measure
    type: sum
    hidden: false
    sort_type: number
    filter_type: NUMBER
    zenlytic_type: metric
    is_merged_result: false
    color_tag: light_blue
    searchable: false
    canon_date: order_lines.order
    sql: ${revenue} * 3
    sql_start: null
    sql_end: null
    description: >-
      Triple Revenue represents three times the revenue amount. It is calculated
      by multiplying the revenue value by 3, so it contains numeric totals
      (e.g., currency amounts) in the same units as the original revenue.
    formatter: usd
    disable_percentile: false
    tags: null
    link: null
    drill_up_id: null
    drill_down_id: null
    question_types:
      - what
      - analyze_baskets
      - funnel
    column_inclusion_ids:
      - order_lines.ORDER_LINE_ID
      - order_lines.CUSTOMER_ID
      - order_lines.ORDER_ID
      - order_lines.PRODUCT_ID
      - order_lines.DISCOUNT
      - order_lines.REVENUE
      - order_lines.PRICE
      - order_lines.QUANTITY
      - __mappings__.CAMPAIGN
      - order_lines.PROMOTION
      - order_lines.SUBSCRIPTION_VS_OTP
      - __mappings__.MARKETING_SOURCE
      - __mappings__.MARKETING_CHANNEL
      - order_lines.LAST_CLICK_MARKETING_CHANNEL
      - order_lines.FIRST_CLICK_MARKETING_CHANNEL
      - order_lines.NEW_VS_REPEAT
    mapped_field_ids: []
    is_personal_field: false
    linked_field_id: null
    is_mapping: false
    is_marked_as_read: false
    topics:
      - Order Analysis
    combined_sql_md5: eeb02e756882e52595a0914ba002354a
    window: null
    percentile: null
    group_label: null
    required_access_grants: null
    extra: null
    measure: null
    synonyms:
      - sales
      - revenue
    cumulative_where: null
    zoe_description: null
    value_format_name: usd
    filters: []
    sql_distinct_key: null
    non_additive_dimension: null
    label_prefix: null
    update_where_timeframe: true
    dynamic_filters: null
    referenced_field_id: null
    aggregation: null
    is_dynamic_field: null
    number_of_uses: 0
