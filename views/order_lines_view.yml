version: 1
type: view
name: order_lines
model_name: pure_organics
sql_table_name: DEMO_RAW.ORDER_LINES
default_date: order_at
fields:
- name: order_line_id
  field_type: dimension
  type: string
  sql: ${TABLE}.ORDER_LINE_ID
- name: product_id
  field_type: dimension
  type: string
  sql: ${TABLE}.PRODUCT_ID
- name: customer_id
  field_type: dimension
  type: string
  sql: ${TABLE}.CUSTOMER_ID
- name: order_id
  field_type: dimension
  type: string
  sql: ${TABLE}.ORDER_ID
- name: marketing_source
  field_type: dimension
  type: string
  sql: ${TABLE}.MARKETING_SOURCE
- name: price
  field_type: dimension
  type: number
  sql: ${TABLE}.PRICE
- name: revenue
  field_type: dimension
  type: number
  sql: ${TABLE}.REVENUE
- name: quantity
  field_type: dimension
  type: number
  sql: ${TABLE}.QUANTITY
- name: marketing_channel
  field_type: dimension
  type: string
  sql: ${TABLE}.MARKETING_CHANNEL
  searchable: true
- name: campaign
  field_type: dimension
  type: string
  sql: ${TABLE}.CAMPAIGN
  searchable: true
- name: order_at
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.ORDER_AT
  description: tester2.

- name: total_revenue
  field_type: measure
  type: number
  sql: SUM(CAST(${revenue} AS FLOAT))
  description: The total revenue from all orders.
- name: average_revenue_per_order
  field_type: measure
  type: number
  sql: AVG(CAST(${revenue} AS FLOAT))
  description: The average revenue generated per order test2 test5.
- name: total_revenue_per_order
  field_type: measure
  type: number
  sql: SUM(CAST(${revenue} AS FLOAT))
  description: The average revenue generated per order.


identifiers:
- name: order_line_id
  type: primary
  sql: ${order_line_id}
- name: product_id
  type: foreign
  sql: ${product_id}
- name: customer_id
  type: foreign
  sql: ${customer_id}
- name: order_id
  type: foreign
  sql: ${order_id}