version: 1
type: view
name: account
model_name: pure_organics
sql_table_name: PEOPLE_PULSE_RAW.ACCOUNT
default_date: contract_start_date
identifiers:
- name: account_id
  type: primary
  sql: ${account_id}
fields:
- name: account_id
  field_type: dimension
  type: number
  sql: ${TABLE}."ACCOUNT_ID"

- name: account_name
  field_type: dimension
  type: string
  sql: ${TABLE}."ACCOUNT_NAME"
  searchable: false

- name: annual_revenue
  field_type: dimension
  type: number
  sql: ${TABLE}."ANNUAL_REVENUE"

- name: contact_email
  field_type: dimension
  type: string
  sql: ${TABLE}."CONTACT_EMAIL"
  searchable: false

- name: contact_name
  field_type: dimension
  type: string
  sql: ${TABLE}."CONTACT_NAME"
  searchable: false

- name: location
  field_type: dimension
  type: string
  sql: ${TABLE}."LOCATION"
  searchable: false

- name: churned
  field_type: dimension
  type: yesno
  sql: ${TABLE}."CHURNED"

- name: size
  field_type: dimension
  type: number
  sql: ${TABLE}."SIZE"

- name: industry
  field_type: dimension
  type: string
  sql: ${TABLE}."INDUSTRY"
  searchable: true

- name: contract_start_date
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}."CONTRACT_START_DATE"

- name: contract_end_date
  field_type: dimension_group
  type: time
  datatype: timestamp
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}."CONTRACT_END_DATE"

- name: total_annual_revenue
  field_type: measure
  type: sum
  description: Total annual revenue from all accounts.
  sql: ${annual_revenue}

- name: average_annual_revenue
  field_type: measure
  type: average
  description: Average annual revenue per account.
  sql: ${annual_revenue}

- name: total_accounts
  field_type: measure
  type: count
  description: Total number of accounts.
  sql: ${account_id}

- name: churned_accounts
  field_type: measure
  type: count
  description: Total number of churned accounts.
  sql: ${account_id}
  filters:
  - field: churned
    value: true


- name: active_accounts
  field_type: measure
  type: count
  description: Total number of active accounts.
  sql: ${account_id}
  filters:
  - field: churned
    value: false


- name: average_account_size
  field_type: measure
  type: average
  description: Average size of accounts.
  sql: ${size}

- name: total_account_size
  field_type: measure
  type: sum
  description: Total size of all accounts.
  sql: ${size}

- name: distinct_industries
  field_type: measure
  type: count_distinct
  description: Number of distinct industries.
  sql: ${industry}

- name: nuqjvlkfgniefulobvhbhvfgigtqudunovispztx
  field_type: measure
  type: average
  label: Duplicate Average Account Size
  description: Average size of accounts.
  sql: ${size}
  canon_date: account.contract_start_date
  update_where_timeframe: true
