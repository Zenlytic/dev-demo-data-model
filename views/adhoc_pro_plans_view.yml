version: 1
type: view
name: adhoc_pro_plans
model_name: my_model
required_access_grants: []
row_label: Adhoc Pro Plans
sets:
  - fields:
      - plan
      - price_per_license
      - plan_type
      - subscription_period
    name: detail
access_filters: []
identifiers:
  - name: plan
    type: primary
    sql: ${plan}
sql_table_name: adhoc_melvin_moncy.pro_plans
fields:
  - name: plan
    field_type: dimension
    type: string
    sql: ${TABLE}.plan
    hidden: true
    primary_key: true
  - name: price_per_license
    field_type: dimension
    type: number
    sql: ${TABLE}.price_per_license
  - name: plan_type
    field_type: dimension
    type: string
    description: 'Types of plan: Free/Pro/Team/Business/Professional/Enterprise/Enterprise(2020)/Enterprise(2021)/Enterprise
      Essentials'
    sql: "CASE\n            WHEN ${TABLE}.plan_type = 'cloud' THEN 'Pro'\n       \
      \     WHEN ${TABLE}.plan_type IS NULL THEN 'Free'\n            ELSE INITCAP(${TABLE}.plan_type)\n\
      \          END"
    group_label: Team Plan
  - name: plan_groups
    field_type: dimension
    type: string
    description: 'Types of plan: Free/Basic/Professional/Enterprise'
    sql: "CASE\n            WHEN ${TABLE}.plan_type IN ('cloud', 'team', 'pro') THEN
      'Basic'\n            WHEN ${TABLE}.plan_type IN ('business', 'enterprise', 'professional')
      THEN 'Professional'\n            WHEN ${TABLE}.plan_type IN ('enterprise (2020)',
      'enterprise (2021)', 'enterprise essentials') THEN 'Enterprise'\n          \
      \  WHEN ${TABLE}.plan_type IS NULL THEN 'Free'\n            ELSE UPPER(LEFT(${TABLE}.plan_type,
      1)) + LOWER(SUBSTRING(${TABLE}.plan_type, 2, LEN(${TABLE}.plan_type)))\n   \
      \       END"
    group_label: Team Plan
  - name: subscription_period
    field_type: dimension
    type: string
    sql: ${TABLE}.subscription_period
