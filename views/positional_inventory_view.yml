version: 1
type: view
name: positional_inventory
model_name: pure_organics
sql_table_name: ANALYTICS.POSITIONAL_INVENTORY
default_date: fiscal_date
identifiers:
- name: loc_number
  type: primary
  sql: ${loc_number}
fields:
- name: eoh_qty
  field_type: dimension
  type: number
  sql: ${TABLE}.EOH_QTY

- name: fiscal_period
  field_type: dimension
  type: string
  sql: ${TABLE}.FISCAL_PERIOD
  searchable: true

- name: receipts_qty
  field_type: dimension
  type: number
  sql: ${TABLE}.RECEIPTS_QTY

- name: loc_number
  field_type: dimension
  type: number
  sql: ${TABLE}.LOC_NUMBER

- name: boh_qty
  field_type: dimension
  type: number
  sql: ${TABLE}.BOH_QTY

- name: fiscal_week
  field_type: dimension
  type: string
  sql: ${TABLE}.FISCAL_WEEK
  searchable: true

- name: net_sales_qty
  field_type: dimension
  type: number
  sql: ${TABLE}.NET_SALES_QTY

- name: fiscal_date
  field_type: dimension_group
  type: time
  datatype: date
  timeframes:
  - raw
  - date
  - day_of_year
  - week
  - week_of_year
  - month
  - month_of_year
  - quarter
  - year
  sql: ${TABLE}.FISCAL_DATE

- name: total_end_of_hand_quantity
  field_type: measure
  type: sum
  description: The total quantity of inventory available at the end of the fiscal
    period.
  sql: ${eoh_qty}

- name: total_receipts_quantity
  field_type: measure
  type: sum
  description: The total quantity of inventory received during the fiscal period.
  sql: ${receipts_qty}

- name: total_beginning_of_hand_quantity
  field_type: measure
  type: sum
  description: The total quantity of inventory available at the beginning of the fiscal
    period.
  sql: ${boh_qty}

- name: total_net_sales_quantity
  field_type: measure
  type: sum
  description: The total quantity of inventory sold during the fiscal period.
  sql: ${net_sales_qty}

- name: average_end_of_hand_quantity
  field_type: measure
  type: average
  description: The average quantity of inventory available at the end of the fiscal
    period.
  sql: ${eoh_qty}

- name: average_receipts_quantity
  field_type: measure
  type: average
  description: The average quantity of inventory received during the fiscal period.
  sql: ${receipts_qty}

- name: average_beginning_of_hand_quantity
  field_type: measure
  type: average
  description: The average quantity of inventory available at the beginning of the
    fiscal period.
  sql: ${boh_qty}

- name: average_net_sales_quantity
  field_type: measure
  type: average
  description: The average quantity of inventory sold during the fiscal period.
  sql: ${net_sales_qty}

- name: inventory_turnover_ratio
  field_type: measure
  type: number
  description: The ratio of net sales to average inventory, indicating how many times
    inventory is sold and replaced over a period.
  sql: nullif(${total_net_sales_quantity}, 0) / nullif((${total_beginning_of_hand_quantity}
    + ${total_end_of_hand_quantity}) / 2, 0)
