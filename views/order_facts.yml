version: 1
type: view
name: order_facts
model_name: pure_organics
default_date: order
identifiers:
- name: primkey
  type: primary
  sql: ${primkey}

fields:
- name: primkey
  field_type: dimension
  type: string
  hidden: true
  primary_key: true
  sql: concat(${order_raw}||${product_type})
  searchable: false

- name: product_title
  field_type: dimension
  type: string
  sql: ${TABLE}.product_title
  searchable: true

- name: product_type
  field_type: dimension
  type: string
  sql: ${TABLE}.product_type
  searchable: true

- name: order
  field_type: dimension_group
  type: time
  datatype: timestamp
  label: Order Date
  description: The time at which the order was placed. This is the main time field
    to use for orders
  timeframes:
  - raw
  - date
  - week_index
  - week
  - month_of_year
  - month
  - quarter
  - time
  - year
  sql: ${TABLE}.order_at

- name: number_of_orders
  field_type: measure
  type: sum
  sql: ${TABLE}.number_of_orders

- name: number_of_units
  field_type: measure
  type: sum
  sql: ${TABLE}.number_of_units

- name: total_cogs
  field_type: measure
  type: sum
  sql: ${TABLE}.total_cogs

